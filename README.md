# Focus Backend Engineer Exercises

Recommended approach:

- For each exercise, create a pull request (PR) and merge your PR into main for your repository

Both exercises involve implementing code and then verifying that the written test cases pass as expected.

All tests are located in `test_backend_engineer_interview.py`

## Structure

```sh
backend-engineer-interview/
  backend_engineer_interview/
    app.py
    handlers.py - Routes should be implemented here
    models.py - Database models, new models should be added here
  tests/
    test_backend_engineer_interview.py - Test cases for the exercises
  app.db - initialized sqlite db
  openapi.yaml - Open API specifications
```

## Setup Instructions

1. Install python@3.12.3. This can be managed with [asdf](https://github.com/asdf-vm/asdf) and [asdf-python](https://github.com/danhper/asdf-python)
2. Install [poetry](https://python-poetry.org/docs/#osx--linux--bashonwindows-install-instructions)
3. Run `poetry config virtualenvs.in-project true`
4. Run `poetry install --no-root`. Installing the dependencies will take a few minutes.
5. Run `poetry run uvicorn backend_engineer_interview.__main__:app --reload` to bring up the API server

## Implementation Notes

- There is a helper `db_session` that can be used to query the db; see the status endpoint for an example
- Connexion works by using the `operationId` defined in the openAPI spec to find a correspondingly named python function to use as the handler
  - See how `/v1/status` is connected to the `status` handler as an example
- Connexion can automatically perform request and response validation based on the open API spec
- For the last few exercises, you'll need to implement a new openAPI specification; you can refer to the one for patching an employee as an example

## Useful documentation

- [Connexion](https://connexion.readthedocs.io/en/latest/index.html)
- [SQLAlchemy](https://docs.sqlalchemy.org/en/20/)

## Exercises

The first three exercises have tests written that are expected to pass.  For the 4th exercise, please write any tests you feel are necessary to confirm the working functionality.

## 1. Implement a GET employee endpoint

### Acceptance Criteria

- As a user I would like to retrieve a user by ID with fields:
  - id
  - first_name
  - last_name
  - date_of_birth
- I should not be able to see the employee's secret
- If the ID does not exist in the DB, I expect to receive a 404

## 2. Implement a PATCH employee endpoint

Acceptance Criteria:

- As a user, I should be able to change an employees first and last name
  - The first and last name must be at least 1 character long and cannot be empty
_ As a user, I would like to receive a 400 status and the relevant error if the request is invalid
- As a user, I should receive a 404 if the ID of the employee to patch does not exist

## 3. Implement a POST application endpoint

Acceptance Criteria:

- As a user, I should be able to POST a new application with the following fields
  - leave_start_date
  - leave_end_date
  - the ID of an employee
- I should receive a 400 if the POST body is invalid
  - Missing fields
  - Employee ID does not exist

## 4. Implement a GET application by employee id, first or last name

Acceptance Criteria:

- As a user, I would like to be able to search for applications
  - I should be able to search by either first name, last name or employee ID
  - If I don't provide any search parameters, I should get all the applications
- As a user, I would like to have paginated results returned

## FAQ

- How do I reset the database?
  Delete the app.db file and run `poetry run alembic upgrade head`
- What URL are the docs at?
  http://localhost:8000/v1/docs
- How do I see an example response?
  If you would like to see the example response generated from the open API definition. Simply comment out `operationId`.
- How do I create new tables from models?
  New tables can be generated by running `poetry run alembic revision --autogenerate -m "Revision name"` and then `poetry run alembic upgrade head`
